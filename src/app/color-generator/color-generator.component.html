<img src="images/transparent-logo.png" alt="Logo" class="print-only print-logo" />
<hr class="no-print">
<div class="table-one-wrapper table-wrapper">
  <form [formGroup]="colorSelectionForm">
    <table id="tableone" class="no-print table-one" formArrayName="colorSelections">
        @for (colorFormControl of colorOptionsFormArray.controls; track colorFormControl; let colorSelectionIndex = $index) {
        <tr [formGroupName]="colorSelectionIndex">
          <td>
            <div class="color-select-row">
              <input 
                  type="radio" 
                  class="radio-input" 
                  formControlName="selectedColor" 
                  [value]="colorFormControl.value.color"
                  (click)="updateOldColor(colorFormControl.value.color)"
                  (change)="updateSelectedColor(colorFormControl.value.color)"
              />
              <div class="dropdown-wrapper">
                <label class="dropdown-label"></label>
                <select 
                  class="color-dropdown" 
                  [style.background-color]="colorFormControl.value.color.hex_value"
                  formControlName="color"
                  (change)="updateColors()"
                >
                  @for (color of colorOptions; track color.id) {
                    <option 
                      [ngValue]="color" 
                      [disabled]="isColorUsed(color)"
                      [style.color]="checkColorContrast(colorFormControl.value.color.hex_value, isColorUsed(color))"
                    >
                      {{ color.name }}
                    </option>
                  }
                </select>
              </div>

            </div>
        </td>
        <td style="width: 80%" class="color-select-row">
          <div class="color-select-row">

          </div>
        </td>
      </tr>
    }
    </table>
  </form>
</div>

<hr class="no-print">

<div class="table-container">
  <div class="table-wrapper">
    <!-- @if (isPrinting) {  Printable Table -->
    <table id="coordinate-table-printable" class="{{ printScaleClass }} print-only">
      <tr class="sticky-header">
        <th></th>
        @for (columns of columnIndices; track $index) {
        <th>{{ headerLetters[$index] }}</th>
        }
      </tr>
      @for (row of rowIndices; track $index; let rowNumber = $index) {
      <tr>
        <th>{{ rowNumber + 1 }}</th>
        @for (column of columnIndices; track $index; let columnNumber = $index) {
        <td>
          @if (isRevealed(rowNumber, columnNumber)) {
          {{ headerLetters[columnNumber] + (rowNumber + 1) }}
          }
        </td>
        }
      </tr>
      }
    </table>
    <!-- } -->
    @if (!isPrinting) { <!-- Visible Table -->
    <cdk-virtual-scroll-viewport itemSize="20" minBufferPx="1200" maxBufferPx="1800" appendOnly
      class="example-viewport screen-only">
      <table id="coordinate-table" class="{{ printScaleClass }}">
        <tr class="sticky-header">
          <th></th>
          @for (columns of columnIndices; track $index) {
          <th>{{ headerLetters[$index] }}</th>
          }
        </tr>
        @for (row of rowIndices; track $index; let rowNumber = $index) {
        <tr>
          <th class="sticky-column">{{ rowNumber + 1 }}</th>
          @for (column of columnIndices; track $index; let columnNumber = $index) {
            @let cellCoordinate = headerLetters[columnNumber] + (rowNumber + 1);
          <td (click)="onCellClick(rowNumber, columnNumber); onTableClick(cellCoordinate)"
          [style.background-color]="getCellBackgroundColor(cellCoordinate)">
            <span [class.hidden]="!isRevealed(rowNumber, columnNumber)">
              {{ cellCoordinate }}
            </span>
          </td>
          }
        </tr>
        }
      </table>
    </cdk-virtual-scroll-viewport>
    }

  </div>
</div>



<div class="print-button-container no-print">
  <button class="primary-button" (click)="printPage()">Print</button>
</div>

<div class="after-print-button-spacer no-print"></div>
